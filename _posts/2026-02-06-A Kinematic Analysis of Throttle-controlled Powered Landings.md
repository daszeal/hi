---
layout: post
title: A Kinematic Analysis of Throttle-controlled Powered Landings
---

SpaceX, NASA, Blue Origin, and many other aerospace agencies have all nearly perfected the suicide burn: a landing maneuver where a spacecraft fires its landing engines at the last possible moment so that vertical velocity reaches zero as it touches the ground, requiring the simultaneous management of altitude, fuel, and vertical velocity. This, however, requires the precise calculations done almost instantly by flight computers, presenting a problem when such resources are limited. In this article, we will provide a solution to this problem: a simple algorithm that can be used to calculate parameters for a rapidly descending vehicle given its velocity and altitude at the predefined re-ignition window, helping to set the baseline reference for flight control computers.

### Model
In this model we assume these four premises: 
1. The spacecraft has a sufficient amount of $$\Delta v$$ for a controlled landing to take place;
2. The spacecraft has negligible horizontal velocity;
3. The spacecraft is in freefall until the point of engine re-ignition;
4. The point of engine re-ignition is identical to the point in time where the spacecraft's state vector is measured.

To model the equation for the descent, we start with the standard kinematic equation, 

$$
v_f^2=v_i^2+2a\Delta x
$$

In this model, 
- The final velocity ($$v_f$$) will be 0;
- The displacement ($$\Delta x$$) will be the altitude ($$h$$) of engine re-ignition;
- The acceleration ($$a$$) will be the net upward acceleration ($$a_{net}$$) generated by the landing engine(s) firing in the retrograde direction.[1]

By reorganizing the formula and substituting new variables, we get this relationship between altitude, initial velocity, and upward acceleration.

$$
h = \frac{v_{initial}^2}{2a_{net}}
$$

Because the vehicle is descending, the total upward acceleration will be the rocket’s acceleration generated from its thrust minus the local gravity.

$$
a_{net}=a_{thrust}-g
$$

Since the acceleration from thrust is the rocket’s thrust-to-weight ratio *TWR* (A *TWR* of 1 or lower will not slow down the rocket in any way, making it imperative to reignite more engines to prevent an uncontrolled loss-of-mission.) times the local gravity, we get

$$
a_{net}=TWR * g-g
$$

Substituting this into the original kinematic equation and rearranging the variables, we get that

$$
h = \frac{v_{initial}^2}{2(TWR*g-g)}
$$

As this equation requires both altitude and velocity, neither of which are controllable without burning extra fuel, we will have to rely on throttle control to accurately complete our landing burn, giving us the equation

$$
h = \frac{v_{initial}^2}{2(n \frac{F_{thrust}}{m}-g)}
$$

where n is the throttle of the engine(s), a unit-less number between 0 (engine cutoff) and 1 (full throttle).[2]

For practicality’s sake, specific engines, thrusts, and masses will not be used to model this experiment. Rather, we use different *TWR*s to simulate the net acceleration available to the spacecraft regardless of size (For the same reason, we chose to not model drag coefficients for atmospheric reentry simulations.).

### Results
Using the equations we derived earlier, we can plot the graph of the altitude vs. the descending velocity of various *TWR*s using Python, as shown in Figure 1. This will be helpful for determining how much we should throttle given the current height and velocity of the vehicle. 

For this case, the *TWR*s of 1.5, 2, 2.5, and 3 were used, with 5 being an additional realistic structural limit and 10 being the theoretical limit, mainly used to help identify if the vehicle is beyond recovery. 

<div class="figure">
  <img src="/assets/images/twrgraph.png" class="post-image">

  <p class="caption">
    Figure 1
  </p>
</div>

### Discussion
Shown by Figure 1, as altitude decreases and velocity increases, higher *TWR*s will be needed to successfully land the craft.
We can use this graph to determine our throttle range for a vehicle given its velocity and altitude. 
If the state vector lies on the left side of a descending craft’s *TWR* landing line, then the craft will be able to cut all its velocity before reaching an altitude of 0 if engines are fired immediately. However, since this will result in the craft reaching a hover point above ground and wasting fuel, we should throttle down the engines such that the spacecraft is able to reach the target velocity as its altitude reaches zero instead.
Using the same method of analysis, if the point lies on the right side of a *TWR* line, then the craft is moving too fast for its altitude to be able to decelerate in the altitude provided. It is empirical that we should throttle up immediately or reignite additional engines. If the *TWR* line used is the craft’s maximum *TWR*, then a high-velocity impact with the ground is inevitable. 
The most optimal landing is for the vehicle to adjust the engine throttle such that its *TWR*’s optimal landing line crosses its current velocity vector perfectly. In this scenario, firing the engines at that point in time will slow the rocket down to 0 in precisely the altitude given.
By rearranging the throttle control equation we derived earlier, we reach a specific algorithm that determines the immediate throttle based off of the vehicle’s state vector, 

$$
n=(\frac{v^2_{initial}}{2h}+g)\frac{m}{F_{thrust}}
$$

To ensure a safe and fuel-efficient descent, the on-board flight control system should adjust the throttle to that $$n$$ value, such that the vehicle’s state vector lies tangent to that *TWR*’s optimal landing burn line.

### Conclusion
In this model, a low-throttle, high-altitude burn is kinematically equivalent to a full-throttle, low-altitude burn. In reality, liquid-based rocket engines have a minimum throttle limit, which will prevent high-altitude landing burns from taking place. In addition, a higher altitude increases gravity losses of fuel, making it less fuel-efficient than a burn starting at a lower altitude. 

In contrast, a low-altitude burn increases the chance of the craft crossing its maximum *TWR*’s optimal descent line and resulting in a crash. 

This model also ignores mass changes due to fuel consumption and atmospheric drag, which will contribute to inaccuracies for spacecraft that have low dry masses or higher drag coefficients in atmospheres, or if parachutes are used in atmospheric reentry.

This model assumes minimal horizontal velocity of the craft, where a burn in the retrograde direction is equivalent or nearly equivalent to a burn directly downwards. This may not be the case if the vehicle is approaching the landing site at a considerable angle when the landing burn begins. 

In both the scenarios above, additional safety measures should be taken before launch and landing, such as reserving more fuel for landing in the case of trajectory prediction errors.

### References
[1] Patrick, ``Timing Suicide Burns / Hoverslams,'' *Wandering the Outer Dark*, Jun. 27, 2023. [Online]. Available: https://pdn4kd.github.io/2023/06/27/suicide\_burn.html

[2] user39728, ``Vertical Landing: Calculating start altitude for hoverslam landing burn,'' *Stack Exchange*, Mar. 26, 2021. [Online]. Available: https://space.stackexchange.com/questions/51069/
